
<!DOCTYPE html>
<html>
<head>
    <title>RPi Camera Dashboard</title>
    <style>
        body { background: #111; color: white; font-family: sans-serif; text-align: center; }
        .params { margin-top: 10px; }
        label { margin-right: 10px; }
        input { width: 100px; }
        .live { border: 2px solid white; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>ðŸ“· Raspberry Pi Camera Monitor</h1>
    <img class="live" src="{{ url_for('video_feed') }}" width="640" height="480">
    <div class="params">
        <p><b>Brightness:</b> <span id="lux"></span> |
           <b>Exposure:</b> <span id="exposure"></span> |
           <b>Gain:</b> <span id="gain"></span> |
           <b>Focus:</b> <span id="focus"></span> |
           <b>FPS:</b> <span id="fps"></span> |
		   <b>Sharpness:</b> <span id="sharpness"></span> |
           <b>Bandwidth:</b> <span id="bandwidth"></span> kbps</p>

        <label>Exposure (us): <input id="input_exposure" type="number" value="10000"></label>
        <label>Gain: <input id="input_gain" type="number" step="0.1" value="1.0"></label>
        <button onclick="setParams()">Apply</button>
        <button onclick="capture()">ðŸ“¸ Capture</button>
    </div>

    <script>
        function updateParams() {
            fetch('/camera_params')
                .then(res => res.json())
                .then(data => {
                    document.getElementById('lux').textContent = data.brightness;
                    document.getElementById('exposure').textContent = data.exposure;
                    document.getElementById('gain').textContent = data.analog_gain;
                    document.getElementById('fps').textContent = data.fps;
                    document.getElementById('focus').textContent = data.focus;
                    document.getElementById('sharpness').textContent = data.sharpness_score;
                    document.getElementById('bandwidth').textContent = data.bandwidth_kbps;
                });
        }
        function setParams() {
            const exposure = document.getElementById('input_exposure').value;
            const gain = document.getElementById('input_gain').value;
            fetch('/set_params', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({exposure, gain})
            });
        }
        function capture() {
            fetch('/capture')
                .then(res => res.json())
                .then(data => alert("Saved: " + data.file));
        }

        setInterval(updateParams, 1000);
    </script>
</body>
</html>

