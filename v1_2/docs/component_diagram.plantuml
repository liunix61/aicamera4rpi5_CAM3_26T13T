@startuml Component Diagram
!theme plain
skinparam backgroundColor #FFFFFF
skinparam componentStyle rectangle

package "AI Camera System v2" {
    
    package "Core Components" {
        [Camera Manager] as CAM_MGR
        [Detection Thread] as DETECT
        [Health Monitor] as HEALTH
        [Database Manager] as DB_MGR
        [Flask Web Server] as FLASK
    }
    
    package "AI Models" {
        [Vehicle Detection Model] as VEH_MODEL
        [License Plate Detection Model] as LP_MODEL
        [Hailo OCR Model] as HAILO_OCR
        [EasyOCR] as EASY_OCR
    }
    
    package "Image Processing" {
        [Image Processing Utils] as IMG_PROC
        [Camera Configuration] as CAM_CONFIG
    }
    
    package "Web Interface" {
        [Live Camera View] as LIVE_VIEW
        [Detection Results] as DETECT_VIEW
        [Detection Detail] as DETAIL_VIEW
        [Health Monitoring] as HEALTH_VIEW
        [API Endpoints] as API
    }
    
    package "Data Storage" {
        [SQLite Database] as SQLITE
        [Image Storage] as IMG_STORE
        [Log Files] as LOGS
    }
    
    package "External Systems" {
        [Hailo AI Accelerator] as HAILO
        [Raspberry Pi Camera] as RPI_CAM
        [Web Browser] as BROWSER
    }
}

' Internal connections
CAM_MGR --> RPI_CAM : controls
CAM_MGR --> CAM_CONFIG : uses
CAM_MGR --> DETECT : provides frames
CAM_MGR --> HEALTH : monitored by

DETECT --> VEH_MODEL : uses
DETECT --> LP_MODEL : uses
DETECT --> HAILO_OCR : uses
DETECT --> EASY_OCR : uses
DETECT --> IMG_PROC : uses
DETECT --> DB_MGR : saves results
DETECT --> IMG_STORE : saves images

HEALTH --> CAM_MGR : monitors
HEALTH --> DB_MGR : logs status
HEALTH --> LOGS : writes logs

FLASK --> CAM_MGR : controls
FLASK --> DETECT : manages
FLASK --> HEALTH : monitors
FLASK --> DB_MGR : queries
FLASK --> API : provides
FLASK --> IMG_STORE : serves images

API --> LIVE_VIEW : serves
API --> DETECT_VIEW : serves
API --> DETAIL_VIEW : serves
API --> HEALTH_VIEW : serves

VEH_MODEL --> HAILO : runs on
LP_MODEL --> HAILO : runs on
HAILO_OCR --> HAILO : runs on

BROWSER --> FLASK : accesses
BROWSER --> LIVE_VIEW : displays
BROWSER --> DETECT_VIEW : displays
BROWSER --> DETAIL_VIEW : displays
BROWSER --> HEALTH_VIEW : displays

' Data flow
RPI_CAM --> CAM_MGR : video stream
CAM_MGR --> DETECT : frames
DETECT --> DB_MGR : detection data
DETECT --> IMG_STORE : images
DB_MGR --> SQLITE : persistent storage
HEALTH --> LOGS : health logs
FLASK --> BROWSER : web interface

@enduml 